!!! Strict
%html{:xmlns => "http://www.w3.org/1999/xhtml", "xml:lang" => "en", :lang => "en"}
  %head
    :css
      * { margin: 0; padding: 0; }

      #widget { font-family: Arial; }
      #widget a, #widget a:visited { color: #107FC9 }
      #widget .head {
        padding: 8px;
        background-color: #2c2a25; -moz-border-radius: 4px 4px 0 0; -webkit-border-radius: 4px 4px 0 0;
      }
      #widget .body {
        background-color: #E3E3D9;
        overflow: auto;
      }
      #widget .foot {
        padding: 10px 0;
        color: #fff; background-color: #2c2a25; -moz-border-radius: 0 0 4px 4px; -webkit-border-radius: 0 0 4px 4px;
      }
      #widget .donate { font-size: 14px; line-height: 17px; color: #fff; }
      #widget a.pledge {
        padding: 5px 8px 4px 8px;
        margin:20px 8px;
        cursor: pointer; color: #fff; font-size: 14px; line-height: 20px; border: none; text-decoration: none; text-transform: capitalize; -moz-border-radius: 3px; -webkit-border-radius: 3px; font-family: Arial; background: url('#{absolute_url('/art/bgs/greenGradient-bg.jpg')}');
      }
      #widget a.pledge:hover { background-position: 0 40px; }
      #widget a.pledge { color: #fff; }
      #widget h3 { font-size: 16px; color: #fff; }
      #widget ul.features li {
        padding: 8px;
        color: #2C2A25; font-size: 13px; line-height: 15px; list-style: none; border-bottom: 1px solid #d6d5cf;
      }

  %body#widget
    .head
      %h3<
        Support
        %a{target: '_new', href: absolute_url(:project, @project.slug)}= @project.name
      %p.donate<
        %a{target: '_new', href: absolute_url(:project, @project.slug, :donation, :new)} Donate
        to this project.
    .body
      - features = paginate(@project.features.top, limit: params[:limit] || 5)
      - if features.empty?
        %ul.features
          %li= @project.summary
      - else
        %ul.features
          - features.each do |feature|
            %li
              %a{target: '_new', href: absolute_url(:feature, feature.slug)}= feature.name
              != money feature.balance
              pledged by
              = feature.pledges.size.to_i
              = "#{feature.pledges.size == 1 ? 'person' : 'people'}."
    .foot
      %p
        %a.pledge{target: '_new', href: absolute_url(:project, @project.slug, :feature, :new)} Fund a new feature
    %script{type: 'text/javascript', src: 'https://ajax.googleapis.com/ajax/libs/jquery/1.4.4/jquery.min.js'}
    :javascript
      $(function () {
        $(window).resize(function () {
          var cruft = $("#widget .head").outerHeight() + $("#widget .foot").outerHeight();
          $("#widget .body").css({"height": ($(window).height() - cruft) + "px"});
        }).resize();
      });
